<div>
  <script>
    function initMap(){
      const myLatlng = { lat: 43.6532, lng: -79.3832 };
      const options ={
        zoom: 10,
        center: myLatlng
      };
      const map = new google.maps.Map(document.getElementById("map"), options);
      const image = "imgs/map-pin.png";

        // Create the initial InfoWindow.
      let infoWindow = new google.maps.InfoWindow({
        content: "Click the map to get Lat/Lng!",
        position: myLatlng,
      });

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (position) => {
            const pos = {
              lat: position.coords.latitude,
              lng: position.coords.longitude,
            };
            infoWindow.setPosition(pos);
            infoWindow.setContent("Current Location");
            infoWindow.open(map);
            map.setCenter(pos);
            document.getElementById("position").innerHTML = JSON.stringify(pos);
          },
          () => {
            handleLocationError(true, infoWindow, map.getCenter());
          }
        );
      }

      infoWindow.open(map);
      // Configure the click listener.
      map.addListener("click", (mapsMouseEvent) => {
        // Close the current InfoWindow.
        infoWindow.close();
        // Create a new InfoWindow.
        // infoWindow = new google.maps.InfoWindow({
        //   position: mapsMouseEvent.latLng,
        // });

        const infoContent =
        `<form class="form-inline" action="/new-map" method="POST">` +
          `<div id="current-position">` +
            `<h4>Map details:</h4>` +
            `<h4>position selected:</h4>` +
            `<p id="position">click the map or select current position</p>` +
            `<button id="auto-input" class="btn btn-outline-primary">use this position</button>` +
            `<input id="positionImport" type="text" name="position" placeholder="position">` +
            `<input type="text" name="title" placeholder="title">` +
            `<h4>category</h4>` +
            `<select name="category" id="category">` +
              `<option value="drinking">drinking</option>` +
              `<option value="restaurants">restaurants</option>` +
              `<option value="art galleries">art galleries</option>` +
              `<option value="historic places">historic places</option>` +
              `<option value="parks">parks</option>` +
              `<option value="shopping malls">shopping malls</option>` +
            `</select>` +
            `<textarea name="description" type="text" placeholder="description"></textarea>` +
            `<button type="submit" class="btn btn-outline-primary">submit</button>` +
          `</div>` +
          `</form>`;

        infoWindow = new google.maps.InfoWindow({
          content: infoContent,
          position: mapsMouseEvent.latLng,
          pixelOffset: new google.maps.Size(500, 0)
        });

        const beachMarker = new google.maps.Marker({
          position: mapsMouseEvent.latLng,
          map,
          icon: {url: image, scaledSize: new google.maps.Size(50, 50)}
        });

        document.getElementById("position").innerHTML=JSON.stringify(mapsMouseEvent.latLng.toJSON(), null, 2);
        //infoWindow.setContent("Select this location!");
        // infoWindow.setContent({content: infoContent});
        map.setZoom(12);
        map.setCenter({lat: infoWindow.position.lat(), lng: infoWindow.position.lng()});
        infoWindow.open(map);
      });
    }
  </script>
  <script
  src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC6z5vqv2nyIpDCo9Jovbl9uZkSXlHn-0E&callback=initMap&libraries=&v=weekly"
  async
  ></script>
</div>
